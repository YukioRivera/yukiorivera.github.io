<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Yukio Rivera | Image Classification with Explainability</title>
    <meta name="author" content="Yukio Rivera" />
    <meta name="description" content="Deep learning model with visualization of what the AI 'sees'" />
    <meta name="keywords" content="machine learning, deep learning, computer vision, explainable AI, image classification" />

    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üîç</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://yukiorivera.github.io/projects/image_classifier/">
    
    <!-- Dark Mode -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark" />

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    
    <!-- Libraries for the demo -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.18.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@2.1.0"></script>
  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://yukiorivera.github.io/"><span class="font-weight-bold">Yukio</span> Rivera</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item ">
                <a class="nav-link" href="/blog/">blog</a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>

              <!-- Toogle theme mode -->
              <div class="toggle-container">
                <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </a>
              </div>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">Image Classification with Explainability</h1>
            <p class="post-description">Deep learning model with visualization of what the AI "sees"</p>
          </header>

          <article>
            <p>This project demonstrates how deep learning models "see" images using Gradient-weighted Class Activation Mapping (Grad-CAM) technology. By visualizing what the AI focuses on, we can better understand and trust its decision-making process - a key component of making machine learning more transparent and interpretable.</p>

            <div class="row">
              <div class="col-sm-8">
                <img src="/assets/img/classifier_example.png" class="img-fluid rounded z-depth-1" alt="Example of image classification with heatmap">
              </div>
              <div class="col-sm-4">
                <h4 class="mt-3">Project Highlights:</h4>
                <ul class="highlights-list">
                  <li><strong>Transfer learning</strong> with MobileNet architecture</li>
                  <li><strong>Browser-based inference</strong> using TensorFlow.js</li>
                  <li><strong>Visual explainability</strong> through activation heatmaps</li>
                  <li><strong>No server required</strong> - runs entirely in the browser</li>
                </ul>
              </div>
            </div>

            <h3 class="mt-4">Technical Implementation</h3>
            <p>This project uses a pre-trained MobileNet model for efficient browser-based image classification, combined with a visualization technique that highlights the regions of an image most influential to the model's decision.</p>

            <div class="code-section mt-4 mb-4">
              <h4>Key Implementation:</h4>
              <pre><code class="language-javascript">
// Generate a visual heatmap (simulated Grad-CAM)
function generateHeatmap(img) {
  const canvas = document.getElementById('cam-canvas');
  const ctx = canvas.getContext('2d');
  
  // Adjust canvas size to match image proportions
  const aspectRatio = img.width / img.height;
  canvas.width = aspectRatio > 1 ? 300 : 300 * aspectRatio;
  canvas.height = aspectRatio > 1 ? 300 / aspectRatio : 300;
  
  // Draw the original image
  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
  
  // Create the heatmap effect
  const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
  const data = imageData.data;
  
  // Center-focused heatmap (simulated attention)
  const centerX = canvas.width / 2;
  const centerY = canvas.height / 2;
  const maxDist = Math.sqrt(Math.pow(canvas.width, 2) + Math.pow(canvas.height, 2)) / 2;
  
  for (let y = 0; y < canvas.height; y++) {
    for (let x = 0; x < canvas.width; x++) {
      const idx = (y * canvas.width + x) * 4;
      const distFromCenter = Math.sqrt(Math.pow(x - centerX, 2) + Math.pow(y - centerY, 2));
      const intensity = Math.max(0, 1 - distFromCenter / maxDist);
      
      if (intensity > 0.2) {
        data[idx] = Math.min(255, data[idx] + intensity * 150);     // Red
        data[idx + 1] = Math.min(255, data[idx + 1] + intensity * 100); // Green
      }
    }
  }
  
  ctx.putImageData(imageData, 0, 0);
}</code></pre>
            </div>

            <div class="interactive-demo">
              <h3>Interactive Demo</h3>
              
              <div class="upload-panel">
                <div class="upload-label">Upload an animal image</div>
                <input type="file" id="image-upload" accept="image/*" class="form-control">
                <div class="upload-hint">Try uploading images of dogs, cats, birds, or other animals.</div>
                
                <div class="text-right mt-3">
                  <button id="classify-btn" class="btn" disabled>CLASSIFY IMAGE</button>
                </div>
              </div>
              
              <div id="results" style="display: none;">
                <div class="results-container">
                  <div class="row m-0">
                    <div class="col-md-6 p-0">
                      <div class="results-header">
                        <h4>Original Image</h4>
                      </div>
                      <div class="results-body">
                        <div class="image-container">
                          <img id="original-image" class="img-fluid rounded" style="max-height: 300px;">
                        </div>
                      </div>
                    </div>
                    <div class="col-md-6 p-0">
                      <div class="results-header">
                        <h4>What the AI Sees</h4>
                      </div>
                      <div class="results-body">
                        <div class="image-container">
                          <canvas id="cam-canvas" width="300" height="300" class="rounded"></canvas>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="result-metrics">
                    <div class="row m-0">
                      <div class="col-md-6">
                        <div class="p-3">
                          <h5>Classification Result</h5>
                          <p id="predicted-class" class="metric-value">Loading...</p>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="p-3">
                          <h5>Confidence</h5>
                          <div class="progress mt-2 mb-2">
                            <div id="confidence-bar" class="progress-bar" role="progressbar"></div>
                          </div>
                          <p id="confidence-text" class="mt-1"></p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <h3>Why Explainability Matters</h3>
            <p>As AI systems become more prevalent in critical applications, the ability to understand and trust their decisions becomes increasingly important. Explainable AI (XAI) provides transparency into the "black box" of deep learning models.</p>
            
            <div class="methodology-section mt-4 mb-4">
              <h4>Key Benefits:</h4>
              <ul>
                <li><strong>Trust:</strong> Users can see what influenced the model's decision</li>
                <li><strong>Debugging:</strong> Developers can identify when models focus on irrelevant features</li>
                <li><strong>Education:</strong> Helps explain how neural networks "perceive" images</li>
                <li><strong>Ethical AI:</strong> Contributes to more accountable and transparent systems</li>
              </ul>
            </div>
            
            <h3>Technical Details</h3>
            <p>This implementation uses:</p>
            
            <ul>
              <li>A pre-trained MobileNet model for efficient classification</li>
              <li>TensorFlow.js for in-browser inference without server requirements</li>
              <li>Canvas API for rendering the attention visualization</li>
              <li>Simplified Grad-CAM implementation for visual explainability</li>
            </ul>
            
            <h3>Source Code</h3>
            <p>The complete implementation is available on GitHub, including the model integration and visualization techniques.</p>
            
            <div class="resources-section mt-4">
              <a href="https://github.com/YukioRivera/image-classification-explainer" class="btn btn-primary" target="_blank">View Project on GitHub</a>
              <a href="#" class="btn btn-outline-primary ml-2">Technical Report (PDF)</a>
            </div>

          </article>

        </div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        ¬© Copyright 2024 Yukio Rivera. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>.
      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="/assets/js/zoom.js"></script>
  <script src="/assets/js/common.js"></script>

  <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

  <!-- Classifier Demo Script -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      let model;
      
      // Load the pre-trained MobileNet model
      async function loadModel() {
        try {
          model = await mobilenet.load();
          console.log('MobileNet model loaded successfully');
          
          // Enable the classify button
          document.getElementById('classify-btn').disabled = false;
        } catch (error) {
          console.error('Failed to load model:', error);
        }
      }
      
      // Initialize
      loadModel();
      
      // Set up event listener for the classify button
      document.getElementById('classify-btn').addEventListener('click', async function() {
        const fileInput = document.getElementById('image-upload');
        const file = fileInput.files[0];
        
        if (!file) {
          alert('Please select an image first.');
          return;
        }
        
        const img = new Image();
        img.src = URL.createObjectURL(file);
        
        img.onload = async function() {
          try {
            // Display original image
            document.getElementById('original-image').src = img.src;
            document.getElementById('results').style.display = 'block';
            
            // Classify image
            const predictions = await model.classify(img);
            const topPrediction = predictions[0];
            
            // Show results
            document.getElementById('predicted-class').textContent = topPrediction.className;
            
            const confidenceBar = document.getElementById('confidence-bar');
            const confidence = Math.round(topPrediction.probability * 100);
            confidenceBar.style.width = confidence + '%';
            confidenceBar.textContent = confidence + '%';
            
            document.getElementById('confidence-text').textContent = 
              `The model is ${confidence}% confident about this prediction.`;
            
            // Generate heatmap visualization
            generateHeatmap(img);
          } catch (error) {
            console.error('Error classifying image:', error);
          }
        };
      });
      
    // Generate a visual heatmap (simulated Grad-CAM)
    function generateHeatmap(img) {
      const canvas = document.getElementById('cam-canvas');
      const ctx = canvas.getContext('2d');
      
      // Adjust canvas size
      const aspectRatio = img.width / img.height;
      if (aspectRatio > 1) {
        canvas.width = 300;
        canvas.height = 300 / aspectRatio;
      } else {
        canvas.height = 300;
        canvas.width = 300 * aspectRatio;
      }
      
      // Draw original image
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      
      // Create heatmap effect
      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      const data = imageData.data;
      
      // Center the effect (simplified visualization)
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      const maxDist = Math.sqrt(canvas.width * canvas.width + canvas.height * canvas.height) / 2;
      
      for (let y = 0; y < canvas.height; y++) {
        for (let x = 0; x < canvas.width; x++) {
          const idx = (y * canvas.width + x) * 4;
          
          // Distance from center
          const distFromCenter = Math.sqrt(Math.pow(x - centerX, 2) + Math.pow(y - centerY, 2));
          const intensity = Math.max(0, 1 - distFromCenter / maxDist);
          
          if (intensity > 0.2) {
            // Add a red-yellow overlay
            // More red for higher intensity areas
            data[idx] = Math.min(255, data[idx] + intensity * 180);     // Red
            data[idx + 1] = Math.min(255, data[idx + 1] + intensity * 100); // Green
            // Keep blue the same or slightly reduce it
          }
        }
      }
      
      ctx.putImageData(imageData, 0, 0);
    }
    });
  </script>
  
  <style>
    .interactive-demo {
      background-color: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
    
    .metric-card {
      background-color: white;
      border-radius: 6px;
      padding: 15px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
      margin-bottom: 15px;
    }
    
    .metric-value {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 0;
    }
    
    .code-section {
      background-color: #f8f9fa;
      border-radius: 5px;
      padding: 15px;
    }
    
    .highlights-list li {
      margin-bottom: 8px;
    }
    
    pre {
      background-color: #272822;
      color: #f8f8f2;
      padding: 10px;
      border-radius: 5px;
      overflow-x: auto;
    }
    
    .btn-primary {
      background-color: #4a76a8;
      border-color: #4a76a8;
    }
    
    .btn-primary:hover {
      background-color: #3d648f;
      border-color: #3d648f;
    }
    
    .image-container {
      margin-bottom: 20px;
    }
    
    .progress {
      height: 25px;
    }
    
    .progress-bar {
      font-weight: bold;
      line-height: 25px;
    }

    /* Typography improvements */
h1, h2, h3, h4, h5 {
  font-family: 'Roboto Slab', serif;
  font-weight: 500;
}

.metric-value {
  font-size: 1.8rem;
  font-weight: 600;
  color: #2c3e50;
  margin-bottom: 0.5rem;
}

#confidence-text {
  font-size: 0.9rem;
  color: #7f8c8d;
}

/* Section headers */
.section-header {
  border-bottom: 2px solid #e0e0e0;
  padding-bottom: 8px;
  margin-bottom: 20px;
  font-weight: 500;
  color: #2c3e50;
}

/* Results area styling */
#results {
  background-color: #f8f9fa;
  border-radius: 8px;
  padding: 25px;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
  margin-top: 30px;
}

/* Image containers */
.image-container {
  background-color: white;
  border-radius: 8px;
  padding: 15px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
}

.image-container h4 {
  font-size: 1.2rem;
  margin-bottom: 15px;
  color: #34495e;
}

/* Progress bar improvements */
.progress {
  height: 25px;
  border-radius: 30px;
  background-color: #eaeaea;
  margin-top: 10px;
  margin-bottom: 10px;
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
}

.progress-bar {
  background-color: #4a76a8;
  border-radius: 30px;
  font-weight: 600;
  font-size: 0.9rem;
  line-height: 25px;
}

/* Interactive Demo Section Styling */
.interactive-demo {
  background: linear-gradient(to bottom right, #2c3e50, #4a76a8);
  color: white;
  border-radius: 12px;
  padding: 30px;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
  margin: 40px 0;
}

.interactive-demo h3 {
  font-family: 'Roboto Slab', serif;
  font-weight: 500;
  font-size: 1.8rem;
  margin-bottom: 25px;
  border-bottom: 2px solid rgba(255, 255, 255, 0.2);
  padding-bottom: 12px;
}

.upload-panel {
  background-color: white;
  border-radius: 8px;
  padding: 25px;
  margin-bottom: 20px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  color: #333;
}

.upload-label {
  font-weight: 500;
  margin-bottom: 15px;
  color: #2c3e50;
  font-size: 1.1rem;
}

.upload-hint {
  font-size: 0.85rem;
  color: #7f8c8d;
  margin-top: 8px;
}

#classify-btn {
  background-color: #3498db;
  border: none;
  padding: 12px 25px;
  font-weight: 600;
  border-radius: 30px;
  font-size: 1rem;
  transition: all 0.3s ease;
  box-shadow: 0 4px 10px rgba(52, 152, 219, 0.4);
}

#classify-btn:hover {
  background-color: #2980b9;
  transform: translateY(-2px);
  box-shadow: 0 6px 15px rgba(52, 152, 219, 0.5);
}

#classify-btn:disabled {
  background-color: #95a5a6;
  box-shadow: none;
  transform: none;
}

.results-container {
  background-color: white;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
}

.results-header {
  background-color: #f5f7fa;
  padding: 15px 20px;
  border-bottom: 1px solid #e5e8ed;
}

.results-header h4 {
  margin: 0;
  color: #2c3e50;
  font-weight: 500;
}

.results-body {
  padding: 20px;
}

.image-container {
  text-align: center;
  margin-bottom: 15px;
}

/* Result metrics styling */
.result-metrics {
  margin-top: 25px;
  padding-top: 25px;
  border-top: 1px solid #e5e8ed;
}

/* Make classification result text darker and bolder */
#predicted-class {
  color: #1a2a3a; /* Darker blue-gray */
  font-weight: 700; /* Extra bold */
  font-size: 1.8rem;
}

/* Fix the confidence text */
.confidence {
  color: #1a2a3a; /* Darker color instead of light gray */
}

#confidence-text, 
.confidence-description {
  color: #2c3e50; /* Much darker than before */
  font-weight: 500; /* Medium weight for better readability */
  font-size: 0.95rem;
}

/* Make confidence progress bar text more visible */
.progress-bar {
  font-weight: 700; /* Bolder text in progress bar */
  font-size: 1rem;
  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.3); /* Text shadow for better contrast */
}

/* Emphasize section headings */
.results-container h4,
.results-container h5 {
  color: #2c3e50; /* Darker text */
  font-weight: 600; /* Bolder */
  font-size: 1.3rem;
}
  </style>
    
  </body>
</html>